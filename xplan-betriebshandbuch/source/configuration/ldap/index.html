<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>LDAP</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>LDAP</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>Als LDAP Server wird Active Directory verwendet.</p></div>
<div class="paragraph"><p>Um die Security zu aktivieren, müssen folgende Änderungen an der
<em>WEB-INF/web.xml</em> vorgenommen werden.</p></div>
<div class="paragraph"><p>Der Security Filter muss hinzugefügt werden:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;filter&gt;
  &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;
  &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
  &lt;filter-name&gt;springSecurityFilterChain&lt;/filter-name&gt;
  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Die korrekte Spring Konfiguration muss eingebunden werden:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Folgende Zeilen:

&lt;context-param&gt;
  &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
  &lt;param-value&gt;de.latlon.xplan.manager.web.spring.ManagerWebSpringConfig&lt;/param-value&gt;
&lt;/context-param&gt;

zu folgenden Zeilen abändern:

&lt;context-param&gt;
  &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
  &lt;param-value&gt;de.latlon.xplan.manager.web.spring.ManagerWebSpringConfigWithAdLdapSecurity&lt;/param-value&gt;
&lt;/context-param&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Um die Security zu deaktivieren, müssen der oben genannte Filter
entfernt und die zuerst beschriebene Spring Konfiguration eingebunden
werden.</p></div>
<div class="paragraph"><p>Die Verbindung zum Active Directory Server kann in der Webapp des
XPlanManagers in der Datei <em>WEB-INF/classes/security.properties</em>
konfiguriert werden:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>ldap.server.domain=adserver.lat-lon
ldap.server.url=ldap://adserver.lat-lon:389</code></pre>
</div></div>
<div class="paragraph"><p>Weiterhin kann dort die Konfiguration für das dynamische Auslesen der
Gruppenhierarchien erfolgen. Dies ist lediglich nötig, wenn dynamische
Gruppenhierarchien genutzt werden (siehe weiter unten):</p></div>
<div class="listingblock">
<div class="content">
<pre><code>ldap.server.searchUser=ll-technical
ldap.server.searchPassword=ADServer!
ldap.server.searchNode=OU=lgvxplanisk,DC=adserver,DC=lat-lon</code></pre>
</div></div>
<div class="paragraph"><p>Hier muss ein (technischer) Nutzer konfiguriert werden, der lesenden
Zugriff auf das Active Directory hat um die Rollen auslesen zu können
(<em>ldap.server.searchUser</em> und <em>ldap.server.searchPassword</em>). Mit dem
Schlüssel <em>ldap.server.searchNode</em> wird die Organisationseinheit mit OU,
und die Domänen Komponenten mit DC in kommaseparierter Form notiert.</p></div>
<div class="paragraph"><p>Die Active Directory-Gruppen mit den dazugehörigen Bezirken auf die die
Gruppe zugreifen darf, die Superuser-Gruppen und die Editor-Gruppen
können in der Webapp des XPlanManagers in der Datei
<em>WEB-INF/classes/security-configuration.xml</em> konfiguriert werden:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;util:list id="groupsSuper" value-type="java.lang.String"&gt;
  &lt;beans:value&gt;SUPER&lt;/beans:value&gt;
&lt;/util:list&gt;

&lt;util:list id="groupsEditor" value-type="java.lang.String"&gt;
  &lt;beans:value&gt;EDITOR&lt;/beans:value&gt;
&lt;/util:list&gt;

&lt;util:map id="groupsTodistricts" key-type="java.lang.String" value-type="java.util.List"&gt;
  &lt;beans:entry key="ALTONA" value-ref="districtsAltona" /&gt;
  &lt;beans:entry key="HARBURG" value-ref="districtsHarburg" /&gt;
  &lt;beans:entry key="HAMBURGNORD" value-ref="districtsHamburgNord" /&gt;
&lt;/util:map&gt;

&lt;util:list id="districtsAltona" value-type="java.lang.String"&gt;
  &lt;beans:value&gt;Altona&lt;/beans:value&gt;
&lt;/util:list&gt;

&lt;util:list id="districtsHarburg" value-type="java.lang.String"&gt;
  &lt;beans:value&gt;Harburg&lt;/beans:value&gt;
&lt;/util:list&gt;

&lt;util:list id="districtsHamburgNord" value-type="java.lang.String"&gt;
  &lt;beans:value&gt;Hamburg-Nord&lt;/beans:value&gt;
&lt;/util:list&gt;

&lt;beans:bean id="grantedAuthoritiesMapper"
            class="de.latlon.xplan.manager.web.spring.security.ActiveDirectoryGrantedAuthoritiesMapper"&gt;
  &lt;beans:constructor-arg index="0"&gt;
    &lt;beans:ref bean="groupsSuper" /&gt;
  &lt;/beans:constructor-arg&gt;
  &lt;beans:constructor-arg index="1"&gt;
    &lt;beans:ref bean="groupsEditor" /&gt;
  &lt;/beans:constructor-arg&gt;
  &lt;beans:constructor-arg index="2"&gt;
    &lt;beans:ref bean="groupsTodistricts" /&gt;
  &lt;/beans:constructor-arg&gt;
  &lt;beans:constructor-arg index="3"&gt;
    &lt;beans:ref bean="roleHierarchy" /&gt;
  &lt;/beans:constructor-arg&gt;
&lt;/beans:bean&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Details zur Konfiguration:</p></div>
<div class="quoteblock">
<div class="content">
<div class="ulist"><ul>
<li>
<p>
Die Liste <em>groupsSuper</em> (momentan mit SUPER gefüllt) stellt eine Liste
aller Superuser-Gruppen dar. Ein Nutzer, der einer Superuser-Gruppe
zugeordnet ist, hat keinerlei Beschränkungen bei der Nutzung des
XPlanManagers.
</p>
</li>
<li>
<p>
Die Liste <em>groupsEditor</em> (momentan mit EDITOR gefüllt) stellt eine
Liste aller Editor-Gruppen dar. Falls ein Nutzer einer Editor-Gruppe
zugeordnet ist, kann dieser alle Pläne aus Bezirken editieren, für die
der Nutzer Rechte hat (siehe nächste Zeile).
</p>
</li>
<li>
<p>
Die Map <em>groupsTodistricts</em> (momentan mit ALTONA, HARBURG und
HAMBURGNORD gefüllt) muss eine Active Directory-Gruppe als Key erhalten
und als Value eine Liste aller Bezirke, auf welche die Gruppe zugreifen
darf. Ein LDAP-Nutzer, der einer oder mehrerer dieser Gruppen zugeordnet
ist, besitzt Rechte für die jeweils konfgurierten Bezirke.
</p>
</li>
<li>
<p>
Die Listen der Bezirke <em>groupsTodistricts</em> (momentan mit Altona,
Harburg und Hamburg-Nord gefüllt) stellen eigene Spring-Beans dar und
werden von der zuvor beschriebenen Map referenziert.
</p>
</li>
<li>
<p>
Der <em>grantedAuthoritiesMapper</em> nutzt die zuvor konfigurierten Rechte.
Diese Bean darf im Normalfall nicht manipuliert werden! Sie sollte
lediglich modifiziert werden, wenn Gruppenhierarchien deaktiviert werden
sollen (siehe nächster Absatz).
</p>
</li>
<li>
<p>
Achtung: In der Beispielkonfiguration wird eine Gruppenhierarchie
genutzt. Der nächste Absatz muss zwingend beachtet werden.
</p>
</li>
</ul></div>
</div>
<div class="attribution">
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="gruppenhierarchien">Gruppenhierarchien</h2>
<div class="sectionbody">
<div class="paragraph"><p>Es können Gruppenhierarchien konfiguriert werden, um hierarchische
Abhängigkeiten zwischen Gruppen abzubilden. So kann eine Gruppen
Mitglied einer anderen Gruppe sein und dabei die Eigenschaften der
übergeordneten Gruppe übernehmen.</p></div>
<div class="paragraph"><p>Beispiel: Gruppe "Hamburg" ist Mitglied der Gruppe "Editor". Dadurch
hat die Gruppe "Hamburg" die Eigenschaften von "Hamburg" und
"Editor". Die Gruppe "Editor" hat dagegen lediglich die
Eigenschaften von "Editor".</p></div>
<div class="paragraph"><p>Details zur Konfiguration:</p></div>
<div class="quoteblock">
<div class="content">
<div class="ulist"><ul>
<li>
<p>
Das als viertes Konstruktorargument übergebene Argument der Bean
<em>grantedAuthoritiesMapper</em> (siehe vorheriges Konfigurationsbeispiel)
muss der Gruppenhierarchie entsprechen. Dies kann wie in Beispiel 1 in
der Konfiguration direkt erfolgen (das Beispiel konfiguriert HARBURG als
Mitglied der Gruppe EDITOR) oder von der Anwendung aus dem
ActiveDirectory ausgelesen werden, wie in Beispiel 2 gezeigt.
</p>
</li>
<li>
<p>
Sind keine Gruppenhierachien vorhanden, muss das vierte
Konstruktorargument entfernt werden (dies sollte der einzige Fall sein,
in dem der <em>grantedAuthoritiesMapper</em> manipuliert wird).
</p>
</li>
<li>
<p>
Falls eine dynamische Rollenhierarchie wie in Beispiel 2 genutzt wird,
müssen in der Datei <em>WEB-INF/classes/security.properties</em> zwingend der
searchUser, das searchPassword und der searchNode angegeben werden
(siehe weiter oben).
</p>
</li>
</ul></div>
</div>
<div class="attribution">
</div></div>
<div class="paragraph"><p>Beispiel 1 - Konfiguration einer statischen Rollenhierarchie:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;beans:bean id="roleHierarchy" class="org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl"&gt;
  &lt;beans:property name="hierarchy"&gt;
   &lt;beans:value&gt;
     HARBURG &gt; EDITOR
   &lt;/beans:value&gt;
  &lt;/beans:property&gt;
&lt;/beans:bean&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Beispiel 2 - Konfiguration einer dynamischen Rollenhierarchie:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>&lt;beans:bean id="roleHierarchy" class="org.springframework.security.access.hierarchicalroles.RoleHierarchyImpl"&gt;
  &lt;beans:property name="hierarchy"&gt;
    &lt;beans:bean factory-bean="roleHierarchyScanner" factory-method="retrieveRoleHierarchy" /&gt;
  &lt;/beans:property&gt;
&lt;/beans:bean&gt;

&lt;beans:bean id="roleHierarchyScanner"
            class="de.latlon.xplan.manager.web.spring.security.ActiveDirectoryRoleHierarchyScanner"&gt;
  &lt;beans:constructor-arg index="0" value="${ldap.server.url}" /&gt;
  &lt;beans:constructor-arg index="1" value="${ldap.server.domain}" /&gt;
  &lt;beans:constructor-arg index="2" value="${ldap.server.searchUser}" /&gt;
  &lt;beans:constructor-arg index="3" value="${ldap.server.searchPassword}" /&gt;
  &lt;beans:constructor-arg index="4" value="${ldap.server.searchNode}" /&gt;
  &lt;beans:constructor-arg index="5"&gt;
    &lt;beans:ref bean="groupsSuper" /&gt;
  &lt;/beans:constructor-arg&gt;
  &lt;beans:constructor-arg index="6"&gt;
    &lt;beans:ref bean="groupsEditor" /&gt;
  &lt;/beans:constructor-arg&gt;
  &lt;beans:constructor-arg index="7"&gt;
    &lt;beans:ref bean="groupsTodistricts" /&gt;
  &lt;/beans:constructor-arg&gt;
&lt;/beans:bean&gt;</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Sowohl die dynamische als auch die statische Gruppenhierarchie wird
während des Starts der Webapp ausgewertet. Falls es nachträgliche
Änderungen an den Hierarchien gibt, muss die Webapp neu gestartet
werden, damit diese von der Software erkannt und genutzt werden.</td>
</tr></table>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated
 2017-03-14 08:15:28 CET
</div>
</div>
</body>
</html>
