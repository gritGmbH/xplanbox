==== In 3 Schritten zum Validierungsbericht

===== Schritt 1 – Plan hochladen

Laden Sie Ihren Plan bzw. Planarchiv hoch, indem Sie auf „Datei auswählen“ klicken.

[NOTE]
====
Bitte beachten Sie, dass abhängig von Ihrem Browser, "Datei auswählen" auch "Durchsuchen" o.a. heißen kann. 
====

Vom XPlanValidator werden folgende Dateiformate akzeptiert:

* ZIP-Dateien (Dateiendung `.zip`) mit folgendem Aufbau: Im Basisverzeichnis muss das XPlanGML-Instanzdokument mit dem Dateinamen __xplan.gml__ vorhanden sein. Rasterdaten sowie alle im __xplan.gml__ referenzierten Anhänge liegen ebenfalls im Basisverzeichnis der ZIP-Datei. Eine solche ZIP-Datei wird XPlanArchiv genannt.
* GML-Dateien (Dateiendung `.gml`)
* XML-Dateien (Dateiendung `.xml`)

[.bordered]
image::validator/Hochladen.png[Hochladen]

[NOTE]
====
Bitte beachten Sie die Anforderungen an den Dateinamen. Der Dateiname darf nur folgende Zeichen enthalten:

 * Kleinbuchstaben von a-z
 * Großbuchstaben von A-Z
 * Zahlen von 0-9
 * einen Bindestrich (-)
 * einen Unterstrich (_)

Sonderzeichen wie Umlaute, Sonderzeichen oder Leerzeichen sind nicht erlaubt.
====

[NOTE]
====
Die Größe eines Plans hat unmittelbare Auswirkungen auf die Dauer der Validierung.
====

===== Schritt 2 – Bezeichnung des Validierungsberichts und Validierungstyp wählen

Wenn Sie einen Plan hochgeladen haben, steht im Feld „Bezeichnung für den Report“ der Name der Datei ohne Endung.

[.bordered]
image::validator/Validierungsoptionen.png[Validierungsoptionen]

Sie können der aktuellen Validierung, falls notwendig, einen eigenen Namen geben. Dieser erscheint ausschließlich auf dem Validierungsbericht.

[NOTE]
====
Vermeiden Sie auch hier, Umlaute, Sonderzeichen und/oder Leerzeichen.
====

[.bordered]
image::validator/Validierungsoptionen_bezeichnung.png[Validerungsoptionen]

In Ihrem Validierungsbericht später wird Ihre Bezeichnung wie folgt dargestellt:

[.bordered]
image::validator/Validierungsbericht.png[Validierungsbericht]

Wählen Sie nun unter folgenden Validierungstypen:

[.bordered]
image::validator/Validierungstypen.png[Validierungstypen]

Standardmäßig sind alle Validierungstypen selektiert.

*1) Semantische Validierung (optional)*

Die semantische Validierung überprüft die fachlich-inhaltliche Kohärenz der XPlanGML-Datei. Genauer gesagt wird geprüft, ob die Validierungsregeln der Konformitätsbedingungen in der jeweiligen Version eingehalten wurden.

 * 4.0 (194 Regeln)
 * 4.1 (235 Regeln)
 * 5.0 (178 Regeln)
 * 5.1 (184 Regeln)
 * 5.2 (191 Regeln)
 * 5.3 (195 Regeln)

[NOTE]
====
Die Konformitätsregeln sind für die Versionen 5.x optimiert!
====

Eine XPlanGML-Datei ist dann zu der jeweiligen XPlanGML Version konform, wenn das XMLDokument gegen das jeweilige XPlanGML Schema validiert und alle in den Konformitätsbedingungen spezifizierten Regeln erfüllt werden.

[NOTE]
====
Folgende Validierungsregeln werden derzeit nicht durch die semantische Validierung geprüft:

 * 4.1.5.3 Ausschluss von gemischter Geometrie (ab Version 5.0)
 * 5.1.5.3 Ausschluss von gemischter Geometrie (ab Version 5.0)
 * 6.1.5.3 Ausschluss von gemischter Geometrie (ab Version 5.0)
 * 7.1.5.2 Ausschluss von gemischter Geometrie
 * 8.1.5.1 Ausschluss von gemischter Geometrie
 * 8.1.7.1 Einschränkung auf Punktgeometrie

Der Ausschluss von gemischter Geometrie ist bereits durch das GML-Profil abgedeckt. Verstöße fallen somit bereits bei der syntaktischen Validierung auf.

Die Regel "8.1.7.1 Die Einschränkung auf Punktgeometrie" bezieht sich auf LP_Punktobjekt. Dabei handelt es sich um eine abstrakte Klasse, für die es keine abgeleiteten Klassen gibt.
====

[[xplanvalidator-web-geometrisch]]
*2) Geometrische Validierung (optional)*

Bei der geometrischen Validierung wird die Korrektheit der Geometrien überprüft. XPlanung bezieht sich auf das https://www.ogc.org/standards/sfa[Simple Feature Model des OGC]. Räumliche Objekte werden hier als Punkte, Linien oder Flächen mit speziellen geometrischen Eigenschaften modellhaft abgebildet. Als Fehler werden z. B. sich überschneidende Polygone identifiziert.

Folgende Prüfungen werden in Abhängigkeit vom Geometrietyp durchgeführt, es handelt sich um die Basis-Geometrischen Prüfungen:

 * Punkte: Prüfung auf 2D-Koordinaten
 * Linien: Segment-Kontinuität
 * Polygone:
  ** Geschlossenheit (äußere und innere Ringe)
  ** Äußerer Ring: Orientierung im Gegenuhrzeigersinn (Warnung)
  ** Innere Ringe: Orientierung im Uhrzeigersinn (Warnung)
  ** Keine Berührung äußerer Ring / innere Ringe
  ** Kein Schnitt äußerer Ring / innere Ringe
  ** Innere Ringe liegen innerhalb der vom äußeren Ring umschlossenen Fläche
  ** Keine Berührung innere Ringe / innere Ringe
  ** Schnittmenge der von zwei inneren Ringen gebildeten Flächen ist leer
  ** Keine doppelten Stützpunkte (äußere und innere Ringe)
 * MultiPolygone:
  ** Keine Berührung zwischen einzelnen Polygonen
  ** Kein Schnitt zwischen einzelnen Polygonen
  ** alle für Polygone geltenen Prüfungen für jedes einzelne Polygon


Nutzung der Optionen

 * „Geometrische Prüfung der Flächenschlussbedingung (2.2.1.1) überspringen“
+
Bei der Flächenschlussprüfung werden Lücken als Fehler ausgegeben. Ist eine Lücke im Plan gewollt, können Sie die Option "Prüfung der Flächenschlussbedingung (2.2.1.1) überspringen" aktivieren.
 
 * „Geometrische Prüfung des Geltungsbereichs (2.2.3.1) überspringen“
+
Wenn Fehler im Geltungsbereich, z.B. in Kreisbögen, nicht korrigiert werden können, selektieren Sie in Ausnahmefällen die Option „Geometrische Prüfung des Geltungsbereichs (2.2.3.1) überspringen“. Bei Überlappungen des Geltungsbereiches gilt eine Toleranz von 1 mm. Grundsätzlich sollten alle Fehler, die den Geltungsbereich betreffen, behoben werden.

*3) Syntaktische Validierung (obligatorisch)*

Die syntaktische Validierung ist die Voraussetzung für die semantische und geometrische Validierung und ist daher nicht abwählbar.

Bei der syntaktischen Validierung wird die Struktur der XPlanGML-Datei geprüft. Eine syntaktisch valide XPlanGML-Datei muss sowohl den Anforderungen der Wohlgeformtheit von XML entsprechen als auch die vom XPlanGML-Schema definierten Regeln erfüllen.

Die Validierung kann über den Button image:validator/BT_ValidierungStarten.png[] gestartet werden.

===== Schritt 3 – Validierungsergebnis und Validierungsbericht

====== Das Validierungsergebnis

*1) Allgemeine Informationen*

Der Kopf des Validierungsberichts gibt Ihnen einen Überblick über die formalen Informationen.

[.bordered]
image::validator/Validierungsbericht_2.png[Validierungsbericht]

Externe Referenzen zeigen an, ob Rasterdaten in Form von PNG und PGW Dateien vorhanden sind.

*2) Semantische Validierung – valide*

Eine valide semantische Prüfung wird Ihnen wie folgt angezeigt.

[.bordered]
image::validator/Validierung_semantisch-valide.png[Validerung semantisch valide]

Die Anzahl der ausgeführten Validierungsregeln variiert in Abhängigkeit der Version der GML-Datei.

*3) Semantische Validierung – nicht valide*

Am Beispiel der nachfolgenden Abbildung sehen Sie welche Konformitätsbedingung (bzw. Validierungsregel) nicht erfüllt ist.

Die ausgegebene GML-ID gibt Ihnen einen Hinweis, welches Element in der XPlanGML-Datei davon betroffen ist.

[.bordered]
image::validator/Validierung_semantisch-nicht-valide.png[Validerung semantisch nicht valide]

*4) Geometrische Validierung – valide*

Eine valide geometrische Prüfung wird wie folgt angezeigt.

[.bordered]
image::validator/Validierung_geometrisch-valide.png[Validerung geometrisch valide]

Eine geometrische Validierung kann valide sein, aber dennoch Warnungen enthalten.

[.bordered]
image::validator/Validierung_geometrisch-warnung.png[Validerung geometrisch Warnungen]

Warnungen werden angezeigt, wenn bei Polygonen

 * der äußere Ring eine Orientierung gegen den Uhrzeigersinn oder
 * der innere Ring eine Orientierung im Uhrzeigersinn

aufweist.

*5) Geometrische Validierung – nicht valide*

Am Beispiel der nachfolgenden Abbildung sehen Sie, welche Validierungsregeln nicht erfüllt sind.

[.bordered]
image::validator/Validierung_geometrisch-nicht-valide.png[Validerung geometrisch nicht valide]

Die ausgegebene GML-ID gibt Ihnen einen Hinweis, welches Element in der XPlanGML-Datei davon betroffen ist.

*6) Syntaktische Validierung – valide*

Eine valide syntaktische Prüfung wird wie folgt angezeigt.

[.bordered]
image::validator/Validierung_syntaktisch-valide.png[Validerungsoptionen]

*7) Syntaktische Validierung – nicht valide*

[.bordered]
image::validator/Validierung_syntaktisch-nicht-valide.png[Validerung syntaktisch valide]

Wenn die syntaktische Validierung nicht valide ist, werden die semantische und die geometrische Validierung nicht durchgeführt und es ist auch keine Kartenvorschau vorhanden.

[.bordered]
image::validator/Validierung_syntaktisch-nicht-valide-andere.png[Validerung syntaktisch valide]

[.bordered]
image::validator/Kartenvorschau-nicht-verfuegbar.png[Kartenvorschau nicht verfügbar]

====== Der Validierungsbericht

[.bordered]
image::validator/Validierungsbericht_download.png[Validierungsbericht Download]

Der Validierungsbericht kann in den Formaten:

 * HTML
 * PDF
 * XML

exportiert werden.

Geometriefehler können zusätzlich auch als Shapefile und als Grafik gespeichert werden.

Alle Ergebnisdateien, selektierte Reports und Geometriefehler,  werden in einer ZIP-Datei gespeichert. Der Dateiname entspricht der Bezeichnung des Validierungsdurchlaufs.

====== Kartenvorschau

Über den Button image:validator/BT_KartenvorschauOeffnen.png[] wechseln Sie zur Kartenansicht des Plans. Hier kann eine visuelle Überprüfung des Plans vorgenommen werden.

Der Plan wird zentriert in der Kartenvorschau angezeigt.

[.bordered]
image::validator/Kartenvorschau.png[]

[NOTE]
====
Der Plan steht in der Kartenansicht nur für eine begrenzte Zeitspanne (ca. 5 Minuten) zur Verfügung, anschließend ist nur noch die Hintergrundkarte zu sehen.

Die Kartenvorschau visualisiert ausschließlich die Geometrien aus der XPlanGML-Datei.
Angehängte Rasterpläne werden nicht dargestellt.

Bei Plänen, die geometrisch nicht valide sind, kann es zu Problemen bei der Darstellung in der Kartenvorschau kommen.
====


====== Navigation:

Mit image:validator/BT_Zurueck.png[] können Sie die Validierungsoptionen verändern.

Mit image:validator/BT_WeiterenPlan.png[]  kehren Sie zur Startseite zurück und können einen neuen oder geänderten Plan hochladen.